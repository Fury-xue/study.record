#+TITLE: EVENT—RECORD
#+AUTHOR:Simon
#+EMAIL: xue.shumeng@yahoo.com
#+KEYWORDS: key
#+OPTIONS: H:1 toc:0

* 生产事件
** 盛京多媒体
*** 银联通道交易40（盛京卡）
    盛京银行622455卡，银联交易返回40（经银联确认为卡bin列表中无此类卡bin）。

    之后联系盛京：马少为，经其分析称：盛京622455卡bin在银联卡bin列表已注册过
    （实际，银联那里保存的是19位的622455的卡bin信息。因为盛京转账、沈阳交罚等业务走的是盛京的专线，
    不通过银联直连盛京，盛京某前置需要的是16位卡号）。因为我们原客户端是对所有622455的卡做中间去零
    操作，所以我们给到银联的也是16位卡号，所以银联返回40.

    解决办法：在盛京专线的业务刷卡后、输入密码前调用客户端
    shuaka:getParams(fun,"isHandleCardNo","yes")，通知客户端此交易需要对卡号去零处理（只有
    在通知到客户端时才会对卡号处理）。客户端shuaka类中添加isHandleCardNo(booblean)标识，此标识
    默认状态位false，当lua脚本通知到客户端时isHandleCardNo=true。此状态在密码键盘调用结束时（密
    码键的finally块）恢复初始状态。
    
    盛京622955卡，银联返回40.因为622955卡刷出来的19位。需要对其做去零处理。
*** 商户收款返回错误代码：06
    此类交易为盛京银行前置系统返回。因运行部给商户配置的MCC码为理财类，盛京前置根据磁道中第18、43域
    判断此交易为理财类。所以拒绝了交易。目前所有的盛京卡在收款时都应该返回06.
